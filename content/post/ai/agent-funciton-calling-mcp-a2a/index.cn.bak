+++
author = "Lucas Huang"
date = '2025-06-23T10:49:22+08:00'
title = "One article to fully understand Agent, Function Calling, MCP, and A2A"
# description = "This article demonstrates how to deploy a Hugo web application to Azure Static Web Apps"
categories = [
    "AI"
]
tags = [
    "MCP",
    "Function Calling",
    "Agent",
    "A2A",
    
]
image = "cover.png"
draft = true
+++
æœ¬æ–‡å°†ä»åŸºç¡€æ¦‚å¿µå‡ºå‘ï¼Œé€æ­¥è§£æAgentï¼ˆæ™ºèƒ½ä½“ï¼‰ã€Function Callingï¼ˆå‡½æ•°è°ƒç”¨ï¼‰ã€MCPï¼ˆæ¨¡å‹ä¸Šä¸‹æ–‡åè®®ï¼‰åŠA2Aï¼ˆæ™ºèƒ½ä½“åä½œåè®®ï¼‰ï¼Œå¸®åŠ©è¯»è€…ç†è§£ LLM åº”ç”¨çŸ¥è¯†ä½“ç³»ã€‚

> æœ¬æ–‡æ˜¯å‚è€ƒå®˜æ–¹æ–‡æ¡£ã€ç½‘ä¸Šçš„ä¸€äº›æ–‡ç« åè¿›è¡Œæ€»ç»“è€Œæˆï¼Œæ—¨åœ¨è®©ä¸äº†è§£çš„åŒå­¦é˜…è¯»åæœ‰ä¸€ä¸ªå¤§è‡´çš„æ¦‚å¿µã€‚å¤§ä½¬å¯ä»¥ç›´æ¥è·³è¿‡ï¼Œæˆ–è€…ä¹Ÿå¯ä»¥å¸®å¿™çœ‹ä¸‹å†™é”™æ²¡æœ‰å“ˆå“ˆ~
>
> å¦‚æœä½ åœ¨é˜…è¯»è¿‡ç¨‹ä¸­å‘ç°æ–‡ä¸­å­˜åœ¨é”™è¯¯ï¼Œè¯·ä¸€å®šç•™è¨€æŒ‡æ­£ï¼Œæ„Ÿè°¢~

æœ¬æ–‡å°†ä»åŸºç¡€æ¦‚å¿µå‡ºå‘ï¼Œé€æ­¥è§£æAgentï¼ˆæ™ºèƒ½ä½“ï¼‰ã€Function Callingï¼ˆå‡½æ•°è°ƒç”¨ï¼‰ã€MCPï¼ˆæ¨¡å‹ä¸Šä¸‹æ–‡åè®®ï¼‰åŠA2Aï¼ˆæ™ºèƒ½ä½“åä½œåè®®ï¼‰ï¼Œå¸®åŠ©è¯»è€…ç†è§£ LLM åº”ç”¨çŸ¥è¯†ä½“ç³»ã€‚

> æœ¬æ–‡æ˜¯å‚è€ƒå®˜æ–¹æ–‡æ¡£ã€ç½‘ä¸Šçš„ä¸€äº›æ–‡ç« åè¿›è¡Œæ€»ç»“è€Œæˆï¼Œæ—¨åœ¨è®©ä¸äº†è§£çš„åŒå­¦é˜…è¯»åæœ‰ä¸€ä¸ªå¤§è‡´çš„æ¦‚å¿µã€‚å¤§ä½¬å¯ä»¥ç›´æ¥è·³è¿‡ï¼Œæˆ–è€…ä¹Ÿå¯ä»¥å¸®å¿™çœ‹ä¸‹å†™é”™æ²¡æœ‰å“ˆå“ˆ~  
>  
> å¦‚æœä½ åœ¨é˜…è¯»è¿‡ç¨‹ä¸­å‘ç°æ–‡ä¸­å­˜åœ¨é”™è¯¯ï¼Œè¯·ä¸€å®šç•™è¨€æŒ‡æ­£ï¼Œæ„Ÿè°¢~

## Agent
### Agent æ˜¯ä»€ä¹ˆï¼Ÿ
**Agentï¼ˆæ™ºèƒ½ä½“ï¼‰**â€‹ æ˜¯ä¸€ä¸ªèƒ½å¤Ÿ **æ„ŸçŸ¥ç¯å¢ƒã€è‡ªä¸»å†³ç­–ã€æ‰§è¡ŒåŠ¨ä½œ** çš„å®ä½“ã€‚åœ¨å¤§æ¨¡å‹åœºæ™¯ä¸­ï¼ŒAgent é€šå¸¸åŸºäºå¤§è¯­è¨€æ¨¡å‹ï¼ˆLLMï¼‰ä½œä¸ºæ ¸å¿ƒæ¨ç†å¼•æ“ï¼Œç»“åˆå¤–éƒ¨å·¥å…·ã€çŸ¥è¯†åº“å’Œå¤šæ¨¡æ€èƒ½åŠ›ï¼Œå®Œæˆå¤æ‚ä»»åŠ¡ã€‚

> å…¶æœ¬è´¨æ˜¯æ„å»ºå…·å¤‡ã€æ€è€ƒ-è¡ŒåŠ¨-è§‚å¯Ÿã€å¾ªç¯ï¼ˆReActï¼‰çš„æ™ºèƒ½ç³»ç»Ÿã€‚

æ ¸å¿ƒèƒ½åŠ›ï¼š

*   **æ¨ç†**ï¼šé€šè¿‡ LLM è§£æç”¨æˆ·æ„å›¾ã€è§„åˆ’ä»»åŠ¡æ­¥éª¤ã€‚  
*   **å·¥å…·è°ƒç”¨**ï¼šè°ƒç”¨å¤–éƒ¨ APIã€æ•°æ®åº“ã€ä»£ç ç­‰å·¥å…·ã€‚  
*   **è®°å¿†ä¸å­¦ä¹ **ï¼šä¿ç•™å†å²äº¤äº’è®°å½•ï¼Œä¼˜åŒ–é•¿æœŸè¡Œä¸ºã€‚

ä¸€å¥è¯æè¿°ï¼š**Agent æ˜¯ä¸€ä¸ªä»¥ LLM ä¸ºåŸºç¡€ï¼Œç»“åˆå…¶ä»–å¤–éƒ¨å·¥å…·è¾…åŠ©ï¼Œæœ€ç»ˆèƒ½å¤Ÿå®Œæˆå¤æ‚ä»»åŠ¡çš„å®ä½“(å·¥å…·ã€åŠ©æ‰‹)**ã€‚

### ä¸ºä»€ä¹ˆéœ€è¦ Agentï¼Ÿ

**å¤§æ¨¡å‹çš„ä¸¤å¤§ç¼ºé™·**ï¼šå¤§æ¨¡å‹å—é™äºè®¡ç®—èµ„æºå’Œè®­ç»ƒæ—¶é—´ï¼Œå¯¼è‡´ä¿¡æ¯æ»åï¼Œå¹¶ä¸”å…¶åŸºäºç»Ÿè®¡è§„å¾‹çš„å›ç­”ç¼ºä¹çœŸæ­£çš„é€»è¾‘æ¨ç†èƒ½åŠ›ã€‚

1ï¼‰**æ²¡æœ‰æœ€æ–°ä¿¡æ¯**ï¼šå¤§æ¨¡å‹çš„è®­ç»ƒéœ€è¦å¤§é‡çš„è®¡ç®—èµ„æºå’Œæ—¶é—´ï¼Œå› æ­¤å®ƒä»¬çš„çŸ¥è¯†åº“é€šå¸¸æ˜¯åœ¨æŸä¸ªæ—¶é—´ç‚¹ä¹‹å‰çš„æ•°æ®é›†ä¸Šè®­ç»ƒçš„ã€‚**ä¾‹å¦‚ï¼ŒGPT-3.5 å’Œ GPT-4 çš„çŸ¥è¯†æˆªè‡³ 2021 å¹´ 9 æœˆ**ã€‚è¿™æ„å‘³ç€å®ƒä»¬æ— æ³•æä¾›æ­¤åçš„æ–°ä¿¡æ¯æˆ–äº‹ä»¶ã€‚ä¸ºä¿æŒæ—¶æ•ˆæ€§ï¼Œéœ€å®šæœŸé‡è®­æ¨¡å‹ï¼Œä½†æˆæœ¬é«˜æ˜‚ä¸”è€—æ—¶ï¼Œå¯¼è‡´å¤§æ¨¡å‹éš¾ä»¥åŠæ—¶è·Ÿä¸Šä¿¡æ¯æ›´æ–°ã€‚  
2ï¼‰**æ²¡æœ‰çœŸé€»è¾‘**ï¼š**å¤§æ¨¡å‹ç”Ÿæˆçš„æ–‡æœ¬å’Œå›ç­”ä¸»è¦åŸºäºè®­ç»ƒæ•°æ®çš„ç»Ÿè®¡è§„å¾‹ï¼Œè€Œéä¸¥æ ¼çš„é€»è¾‘æ¨ç†æˆ–å½¢å¼åŒ–è¯æ˜ã€‚**å› æ­¤ï¼Œåœ¨å¤„ç†å¤æ‚æˆ–éœ€æ·±å…¥é€»è¾‘æ¨ç†çš„é—®é¢˜æ—¶ï¼Œå®ƒä»¬å¯èƒ½äº§ç”Ÿçœ‹ä¼¼åˆç†ä½†å®é™…ä¸å‡†ç¡®çš„å›ç­”ã€‚æ­¤å¤–ï¼Œå¤§æ¨¡å‹é€šè¿‡é¢„æµ‹ç»™å®šä¸Šä¸‹æ–‡ä¸­çš„ä¸‹ä¸€ä¸ªè¯æ¥ç”Ÿæˆæ–‡æœ¬ï¼Œå¯èƒ½å—è®­ç»ƒæ•°æ®ä¸­çš„åè§å’Œé”™è¯¯å½±å“ï¼Œä»è€Œå‰Šå¼±é€»è¾‘ä¸¥è°¨æ€§ã€‚

å› æ­¤ï¼Œä¸ºäº†èƒ½å¤Ÿå®Œæˆæ›´åŠ å¤æ‚çš„ä»»åŠ¡ï¼Œæˆ‘ä»¬éœ€è¦å°†å¤§æ¨¡å‹å’Œå¤–éƒ¨å·¥å…·ç›¸ç»“åˆï¼Œè€Œè½åˆ°å…·ä½“å®ç°ä¸Šä½“ç°å‡ºæ¥å°±æ˜¯ Agentã€‚

### Agent å·¥ä½œæµç¨‹
ä¸¾ä¸ªä¾‹å­ğŸŒ°ï¼šæœ‰ä¸€ä¸ªå¾ˆç®€å•çš„ä»»åŠ¡ï¼Œæˆ‘è¦æŸ¥è¯¢é‡åº†çš„å¤©æ°”ã€‚

å¯¹äºå¤§æ¨¡å‹æ¥è¯´ï¼Œæ²¡æœ‰æœ€æ–°çš„çŸ¥è¯†ï¼Œè‡ªç„¶æ˜¯ä¸çŸ¥é“ä»Šå¤©çš„å¤©æ°”æƒ…å†µï¼Œé‚£ä¹ˆéœ€è¦å€ŸåŠ©å¤–éƒ¨å·¥å…·æ¥å®Œæˆè¿™ä¸ªä»»åŠ¡ï¼Œæ¯”å¦‚è°ƒç”¨å¤©æ°” APIã€‚

æ•´ä¸ªæµç¨‹å¤§æ¦‚å°±æ˜¯è¿™æ ·çš„ï¼š



1ï¼‰ç”¨æˆ·å‘é€ä»»åŠ¡ç»™ Agent  
2ï¼‰Agent è½¬å‘ç»™ LLMï¼Œå¹¶æºå¸¦ä¸Šé…ç½®å¥½çš„ tools ä¿¡æ¯  
3ï¼‰LLM æ ¹æ®é—®é¢˜å’Œ tools ä¿¡æ¯ï¼Œæ‰¾å‡ºéœ€è¦ä½¿ç”¨çš„ tool ä»¥åŠè¯·æ±‚å‚æ•°è¿”å›ç»™ Agent  
4ï¼‰Agent æ ¹æ® 3 ä¸­è¿”å›çš„ä¿¡æ¯è°ƒç”¨å…·ä½“å·¥å…·å¾—åˆ°ç»“æœ  
5ï¼‰å¯¹åº”å·¥å…·å°†ç»“æœè¿”å›ç»™ Agent  
6ï¼‰Agent å°†ç»“æœå‘é€ç»™ LLM  
7ï¼‰LLM æ ¹æ®ä¸Šä¸‹æ–‡ï¼Œæ•´åˆä¿¡æ¯ç”Ÿæˆæœ€ç»ˆç»“æœè¿”å›ç»™ Agent  
8ï¼‰Agent å°†ç»“æœè¿”å›ç»™ç”¨æˆ·  

å¯ä»¥çœ‹åˆ°ï¼Œå¯¹äºè¿™ä¸ªç®€å•çš„ä»»åŠ¡ï¼Œåœ¨æµç¨‹ä¸­ Agent å¥½åƒå°±å¹²äº†ä¸¤ä»¶äº‹ï¼š

1ï¼‰åœ¨ User å’Œ LLM ä¹‹é—´ä¼ è¯  
2ï¼‰é…åˆ LLM è°ƒç”¨å¤–éƒ¨å·¥å…·

å½“ç„¶äº†ï¼ŒçœŸæ­£çš„ Agent è‚¯å®šä¼šæ›´åŠ å¤æ‚ã€‚
### LLM æ˜¯å¦‚ä½•è°ƒç”¨å¤–éƒ¨å·¥å…·çš„
çœ‹å®Œä¸Šé¢çš„ Demo ä¹‹åï¼Œå¤§å®¶å¯èƒ½ä¼šæœ‰ä¸€ä¸ªç–‘é—®ï¼š**å¤§æ¨¡å‹æ˜¯æ€ä¹ˆçŸ¥é“è¿™ä¸ªåŠŸèƒ½è¯¥è°ƒç”¨å“ªä¸ªå¤–éƒ¨å·¥å…·å°±å¯ä»¥å®ç°å‘¢ï¼Œåˆæ€ä¹ˆçŸ¥é“è¿™äº›å·¥å…·è¯¥å¦‚ä½•ä¼ å‚æ•°ï¼Ÿ**

å®é™…ä¸Šå¤§æ¨¡å‹ç¡®å®ä¸çŸ¥é“ï¼Œå› æ­¤æˆ‘ä»¬è¦å°†å¤–éƒ¨å·¥å…·ä¿¡æ¯å‘ŠçŸ¥å¤§æ¨¡å‹ï¼Œ**æ¯”å¦‚åœ¨ System Prompt ä¸­å¢åŠ  tools æè¿°**ã€‚

è¿™æ ·å¤§æ¨¡å‹å°±çŸ¥é“æœ‰å“ªäº›å·¥å…·å¯ä»¥è°ƒç”¨äº†ï¼ŒåŒæ—¶æ ¹æ®ç”¨æˆ·çš„é—®é¢˜èƒ½å¤Ÿè‡ªè¡Œåˆ¤æ–­æ˜¯å¦éœ€è¦è°ƒç”¨å¤–éƒ¨å·¥å…·ï¼Œè‹¥éœ€è¦åˆ™ä»é—®é¢˜ä¸­è§£æå‚æ•°ï¼Œç„¶åä»¥å›ºå®šæ ¼å¼(ä¸€èˆ¬ä¸º JSON)è¿”å›ã€‚

ä¾‹å¦‚ï¼Œå¯ä»¥ä½¿ç”¨ä»¥ä¸‹ System Promptï¼š

```json
ä½ æ˜¯ä¸€ä¸ªæ™ºèƒ½åŠ©æ‰‹ï¼Œå¯ä»¥æ ¹æ®ç”¨æˆ·è¯·æ±‚é€‰æ‹©å¹¶è°ƒç”¨åˆé€‚çš„å¤–éƒ¨å·¥å…·ã€‚ä»¥ä¸‹æ˜¯å·¥å…·åº“å’Œè°ƒç”¨è§„èŒƒï¼š 
[
  {
    "name": "get_weather",
    "description": "æŸ¥è¯¢æŒ‡å®šåŸå¸‚çš„å®æ—¶å¤©æ°”çŠ¶å†µ",
    "invoke_conditions": [
      "å¤©æ°”",
      "æ°”æ¸©",
      "é™é›¨",
      "é£åŠ›"
    ],
    "parameters": [
      {
        "name": "city",
        "type": "string",
        "required": true,
        "extract_rule": "ä»é—®é¢˜ä¸­æå–æ˜ç¡®åŸå¸‚åç§°",
        "examples": [
          "åŒ—äº¬å¸‚",
          "ä¸Šæµ·"
        ]
      },
      {
        "name": "date",
        "type": "date",
        "required": false,
        "default": "å½“å¤©",
        "format": "YYYY-MM-DD",
        "examples": [
          "2024-08-15"
        ]
      }
    ]
  }
]
ä½ éœ€è¦ä¸¥æ ¼æŒ‰ä»¥ä¸‹ JSON æ ¼å¼è¿”å›å·¥å…·è°ƒç”¨ç»“æœï¼Œæ³¨æ„ä¸è¦è¿”å›å…¶ä»–é¢å¤–ä¿¡æ¯ï¼š
{
  "tool": "å·¥å…·åç§°",  // å¿…é¡»ä¸å·¥å…·åº“ä¸­çš„nameå®Œå…¨ä¸€è‡´
  "params": {
    "å‚æ•°1": "å€¼1",   // å‚æ•°åä¸å·¥å…·å®šä¹‰ä¸€è‡´
    "å‚æ•°2": "å€¼2"
  }
}
```

ç„¶åæˆ‘ä»¬å†é—®é—®é¢˜ï¼š

```
å¸®æˆ‘æŸ¥è¯¢é‡åº†çš„å¤©æ°”ã€‚
```

ä»¥ä¸‹ä¸ºå¤§æ¨¡å‹çš„æ€è€ƒè¿‡ç¨‹ï¼š

```
å¥½çš„ï¼Œç”¨æˆ·è®©æˆ‘å¸®å¿™æŸ¥è¯¢é‡åº†çš„å¤©æ°”ã€‚é¦–å…ˆï¼Œæˆ‘éœ€è¦æ£€æŸ¥ç”¨æˆ·çš„é—®é¢˜ä¸­æ˜¯å¦åŒ…å«éœ€è¦è°ƒç”¨å·¥å…·çš„å…³é”®è¯ã€‚æ ¹æ®å·¥å…·åº“ä¸­çš„å®šä¹‰ï¼Œget_weatherå·¥å…·çš„è°ƒç”¨æ¡ä»¶åŒ…æ‹¬â€œå¤©æ°”â€ã€â€œæ°”æ¸©â€ã€â€œé™é›¨â€ã€â€œé£åŠ›â€ç­‰è¯ã€‚ç”¨æˆ·çš„é—®é¢˜é‡Œæ˜ç¡®æåˆ°äº†â€œå¤©æ°”â€ï¼Œæ‰€ä»¥ç¬¦åˆè°ƒç”¨æ¡ä»¶ã€‚
æ¥ä¸‹æ¥ï¼Œæˆ‘éœ€è¦æå–å‚æ•°ã€‚æ ¹æ®å·¥å…·çš„å®šä¹‰ï¼Œå¿…é¡»çš„å‚æ•°æ˜¯åŸå¸‚åç§°cityï¼Œå¯é€‰å‚æ•°æ˜¯æ—¥æœŸdateï¼Œé»˜è®¤å½“å¤©ã€‚ç”¨æˆ·çš„é—®é¢˜ä¸­æ˜ç¡®æåˆ°äº†â€œé‡åº†â€ï¼Œæ‰€ä»¥cityå‚æ•°çš„å€¼åº”è¯¥æ˜¯â€œé‡åº†å¸‚â€ã€‚æ—¥æœŸæ²¡æœ‰ç‰¹åˆ«è¯´æ˜ï¼Œæ‰€ä»¥ä½¿ç”¨é»˜è®¤å€¼â€œå½“å¤©â€ã€‚
ç„¶åï¼Œæˆ‘éœ€è¦ç¡®è®¤å‚æ•°æå–æ˜¯å¦æ­£ç¡®ã€‚ç”¨æˆ·çš„é—®é¢˜ä¸­æ²¡æœ‰æåˆ°å…·ä½“æ—¥æœŸï¼Œæ‰€ä»¥dateå‚æ•°ä¿æŒé»˜è®¤ã€‚åŸå¸‚åç§°æ˜¯å¦æ­£ç¡®ï¼Œç”¨æˆ·å†™çš„æ˜¯â€œé‡åº†â€ï¼Œè€Œå·¥å…·ç¤ºä¾‹ä¸­æœ‰â€œåŒ—äº¬å¸‚â€å’Œâ€œä¸Šæµ·â€ï¼Œä½†æ ¹æ®å¸¸è¯†ï¼Œâ€œé‡åº†â€ä½œä¸ºç›´è¾–å¸‚ï¼Œæ­£ç¡®çš„åç§°åº”è¯¥æ˜¯â€œé‡åº†å¸‚â€ï¼Œä¸è¿‡å·¥å…·çš„å‚æ•°æ˜¯å¦æ¥å—ç®€ç§°å¯èƒ½éœ€è¦ç¡®è®¤ã€‚ä½†æ ¹æ®å·¥å…·çš„å®šä¹‰ï¼Œç¤ºä¾‹ä¸­ç”¨äº†â€œä¸Šæµ·â€ä½œä¸ºç®€å†™ï¼Œæ‰€ä»¥å¯èƒ½å…è®¸ä½¿ç”¨ç®€ç§°ã€‚ä¸è¿‡ä¸ºäº†å‡†ç¡®ï¼Œå¯èƒ½åº”è¯¥ä½¿ç”¨å…¨ç§°â€œé‡åº†å¸‚â€ã€‚ä¸è¿‡ç”¨æˆ·åŸæ–‡æ˜¯â€œé‡åº†â€ï¼Œå¯èƒ½å·¥å…·çš„å‚æ•°æ¥å—è¿™ä¸ªåç§°ï¼Œæ‰€ä»¥ç›´æ¥æå–å³å¯ã€‚
æœ€åï¼ŒæŒ‰ç…§è¦æ±‚ç”ŸæˆJSONæ ¼å¼çš„å“åº”ï¼Œç¡®ä¿å·¥å…·åç§°æ­£ç¡®ï¼Œå‚æ•°æ­£ç¡®æ— è¯¯ï¼Œæ²¡æœ‰å¤šä½™ä¿¡æ¯ã€‚
```

æœ€ç»ˆçš„è¿”å›ç»“æœï¼š

```json
{
  "tool": "get_weather",
  "params": {
    "city": "é‡åº†"
  }
}
```

å¯ä»¥çœ‹åˆ°ï¼Œæ¨¡å‹å¯ä»¥æ ¹æ®é—®é¢˜æ‰¾åˆ°æ­£ç¡®çš„å·¥å…·ï¼Œå¹¶ä¸”ä»é—®é¢˜ä¸­è§£æå‡ºå‚æ•°ï¼Œæœ€ç»ˆä»¥ JSON å½¢å¼è¿”å›äº†è°ƒç”¨è¯·æ±‚ï¼ŒAgent æ”¶åˆ°è¿™ä¸ª JSON æ ¼å¼ä¿¡æ¯åå°±å¯ä»¥çœŸæ­£çš„è°ƒç”¨å¤©æ°” API å»æŸ¥è¯¢å¤©æ°”äº†ã€‚

> ä¸è¿‡éœ€è¦æ³¨æ„çš„æ˜¯ï¼šæ ¹æ®æ¨¡å‹èƒ½åŠ›ä¸åŒï¼Œå¯èƒ½å­˜åœ¨å³ä½¿æ˜ç¡®è¦æ±‚è¾“å‡º JSONï¼Œä»ç„¶å‡ºç° è¯­æ³•é”™è¯¯ã€è½¬ä¹‰å­—ç¬¦é”™è¯¯ã€å¤šå‡ºå†—ä½™æ–‡æœ¬ä¹‹ç±»çš„é—®é¢˜ã€‚  

## Function Calling
### ä»€ä¹ˆæ˜¯ Function Calling
> [https://platform.openai.com/docs/guides/function-calling](https://platform.openai.com/docs/guides/function-calling)

Function Calling ç”± OpenAI åœ¨2023 å¹´ 6 æœˆæ¨å‡ºï¼Œæœ€åˆåœ¨ GPT-3.5 å’Œ GPT-4 æ¨¡å‹ä¸Šå®ç°ï¼Œå®ƒå…è®¸å¤§è¯­è¨€æ¨¡å‹ä¸å¤–éƒ¨å·¥å…·è¿æ¥ï¼Œå°†è‡ªç„¶è¯­è¨€è½¬æ¢ä¸º API è°ƒç”¨ã€‚è¿™è§£å†³äº†å¤§æ¨¡å‹åœ¨è®­ç»ƒç»“æŸï¼Œå°±çŸ¥è¯†æ›´æ–°åœæ»çš„é—®é¢˜ã€‚

OpenAI æ–‡æ¡£ä¸­çš„æè¿°ï¼š

> Function calling provides a powerful and flexible way for OpenAI models to interface with your code or external services.

**Function Calling æ˜¯ç‰¹å®šäºå¤§è¯­è¨€æ¨¡å‹(LLM)çš„æœºåˆ¶ï¼Œå…è®¸æ¨¡å‹è°ƒç”¨å¤–éƒ¨å‡½æ•°æˆ– APIï¼Œå®ƒå…è®¸æ¨¡å‹ç”Ÿæˆç»“æ„åŒ– JSON è¾“å‡ºï¼Œä»¥è°ƒç”¨å¤–éƒ¨ç³»ç»Ÿä¸­é¢„å®šä¹‰çš„å‡½æ•°æˆ– APIã€‚**

é€šè¿‡**è°ƒç”¨å¤–éƒ¨å·¥å…·å’ŒæœåŠ¡**ï¼ŒFunction Calling å¸®åŠ©å¤§æ¨¡å‹è§£å†³äº†æ¯”å¦‚ä»Šå¤©æ¸©åº¦å¤šå°‘åº¦ä¹‹ç±»çš„**å®æ—¶æ€§é—®é¢˜**ã€‚

ä¸€å¥è¯æè¿°ï¼š**Function Calling æ˜¯ä¸€ç§å…è®¸æ¨¡å‹é€šè¿‡ç”Ÿæˆç»“æ„åŒ– JSON è¾“å‡ºï¼Œä»¥â€™è°ƒç”¨â€™å¤–éƒ¨ç³»ç»Ÿä¸­é¢„å®šä¹‰çš„å‡½æ•°çš„æœºåˆ¶ã€‚**

> æ³¨æ„ï¼šè¿™é‡Œçš„â€™è°ƒç”¨â€™æ˜¯å¸¦å¼•å·çš„,**å› ä¸º FunctionCalling å¹¶ä¸æ˜¯ç›´æ¥èµ‹äºˆäº† LLM è°ƒç”¨å¤–éƒ¨å‡½æ•°çš„èƒ½åŠ›**ï¼Œè€Œæ˜¯è®© LLM èƒ½å¤Ÿæ ¹æ®é¢„å®šä¹‰å‡½æ•°åˆ—è¡¨ã€ç”¨æˆ·è¾“å…¥ Prompt ç­‰ç›¸å…³ä¿¡æ¯çŸ¥é“è¯¥è°ƒç”¨å“ªä¸ªå‡½æ•°ï¼Œå¹¶ä»¥æ­¤ç”Ÿæˆç»“æ„åŒ–è¾“å‡ºï¼ŒåŒ…æ‹¬è¯¥è°ƒç”¨çš„å‡½æ•°åã€è¾“å…¥å‚æ•°ç­‰ä»¥ä¾›å¤–éƒ¨å·¥å…·ä½¿ç”¨ã€‚
### ä¸ºä»€ä¹ˆéœ€è¦ Function Calling
**å®é™…ä¸Šï¼Œä¹‹å‰æˆ‘ä»¬é€šè¿‡åœ¨ System Prompt ä¸­æ³¨å…¥ tools ä¿¡æ¯çš„æ–¹å¼å·²ç»å¯ä»¥å®ç°ç±»ä¼¼ Function Calling çš„åŠŸèƒ½äº†**ï¼Œä¸è¿‡è¿™ç§æ–¹å¼ä¸å¤Ÿç¨³å®šï¼Œæ¨¡å‹å¯èƒ½ä¸ä¼šæ¯æ¬¡éƒ½æ­£ç¡®è¿”å›(å–å†³äºæ¨¡å‹èƒ½åŠ›)ã€‚

*   Function Calling æ˜¯å‚å•†ï¼ˆå¦‚ OpenAIã€Anthropicï¼‰é€šè¿‡ **å¾®è°ƒæˆ–æ¶æ„ä¼˜åŒ–**ï¼Œèµ‹äºˆæ¨¡å‹ç”Ÿæˆç»“æ„åŒ–æŒ‡ä»¤ï¼ˆå¦‚ JSONï¼‰çš„èƒ½åŠ›ï¼Œè¿™ç§èƒ½åŠ›ä½¿æ¨¡å‹èƒ½ç²¾å‡†åŒ¹é…é¢„å®šä¹‰å‡½æ•°ï¼Œè€Œéä¾èµ–è‡ªç„¶è¯­è¨€ç”Ÿæˆã€‚  
*   Function Calling æœ¬èº« æ²¡æœ‰ç»Ÿä¸€åè®®ï¼Œä¸åŒå‚å•†å®ç°æ–¹å¼ä¸åŒï¼ˆå¦‚ OpenAI çš„ `tools` å‚æ•°ã€Claude çš„ `tool_use` å­—æ®µï¼‰ã€‚  
    *   è¿™ä¹Ÿæ˜¯ä¸ºä»€ä¹ˆåé¢åˆæ¨å‡ºäº†æ ‡å‡†åŒ–çš„ MCP åè®®,æ—¨åœ¨ç»Ÿä¸€å·¥å…·è°ƒç”¨æµç¨‹ã€‚

Function Calling å’Œ ä½¿ç”¨ System Prompt æ¨¡æ‹ŸäºŒè€…éƒ½æ˜¯è®© LLM è°ƒç”¨å¤–éƒ¨å·¥å…·çš„ä¸€ç§å®ç°ï¼Œæˆ–è€…éƒ½å¯ä»¥ç®—æ˜¯å¹¿ä¹‰ä¸Šçš„ Function Calling ã€‚å…·ä½“åŒºåˆ«åœ¨äºï¼š

*   System Prompt æ¨¡æ‹Ÿæ–¹å¼ï¼šä¸»è¦ä¾èµ–äºæ¨¡å‹çš„è‡ªç„¶è¯­è¨€ç”Ÿæˆèƒ½åŠ›ï¼Œä¸å¤Ÿç¨³å®š  
    *   æ­¤æ—¶çš„æ¨¡å‹åªæ˜¯æ ¹æ® Prompt ç”Ÿæˆè¿”å›  
*   Function Calling åˆ™æ˜¯ç›´æ¥å¯¹æ¨¡å‹è¿›è¡Œå¾®è°ƒï¼Œä»è€Œèµ‹äºˆæ¨¡å‹ç”Ÿæˆç»“æ„åŒ–æŒ‡ä»¤çš„èƒ½åŠ›ï¼Œæ›´åŠ å‡†ç¡®ã€‚  
    *   æ­¤æ—¶çš„æ¨¡å‹ç»è¿‡ç‰¹æ®Šçš„å¾®è°ƒï¼Œèƒ½å¤Ÿæ›´å¥½çš„å¤„ç†è¿™ç§éœ€æ±‚ï¼Œå› æ­¤èƒ½å¤Ÿæ›´åŠ ç²¾å‡†çš„åŒ¹é…é¢„å®šä¹‰å‡½æ•°

ç®€å•ç†è§£å°±æ˜¯åšæ•°å­¦é¢˜ï¼š1+2+3â€¦.+100ã€‚

*   ä¸€ä¸ªæ˜¯ç¡¬ç®—,å¦‚æœæ¯”è¾ƒå¤æ‚çš„ä»»åŠ¡å¯èƒ½å°±ä¼šå‡ºé”™  
*   ä¸€ä¸ªæ˜¯å¥—å…¬å¼,n(n+1)/2ï¼Œå¾ˆè½»æ¾å°±å¾—åˆ°ç»“æœäº†
### FunctionCalling å·¥ä½œæµç¨‹
æµç¨‹å¦‚ä¸‹ï¼š

![Function Calling Diagram Steps](Function-Calling-Diagram-Steps.png)

> å›¾æºï¼š[https://platform.openai.com/docs/guides/function-calling?api-mode=chat#overview](https://platform.openai.com/docs/guides/function-calling?api-mode=chat#overview)

ä¹Ÿæ˜¯åˆ†ä¸ºè¿™å‡ ä¸ªæ­¥éª¤ï¼š

*   1ï¼‰ç”¨æˆ·å®šä¹‰ Tools å¹¶å‘ŠçŸ¥ LLM  
*   2ï¼‰ç”¨æˆ·å‘é€ Prompt ç»™ LLMï¼ŒLLM æ ¹æ®æ‹¿åˆ°çš„ Tools ä¿¡æ¯åˆ¤æ–­éœ€è¦è°ƒç”¨å“ªä¸ªå·¥å…·ï¼Œå¹¶ç”Ÿæˆå¯¹åº” JSON æ ¼å¼è°ƒç”¨è¯·æ±‚  
*   3ï¼‰ç”¨æˆ·æ ¹æ®è¯·æ±‚è°ƒç”¨å…·ä½“å·¥å…·  
*   4ï¼‰ç”¨æˆ·å°†è°ƒç”¨ç»“æœè¿”å› LLM  
*   5ï¼‰LLM æ•´åˆç»“æœè¿”å›æœ€ç»ˆå›å¤

å½“ç„¶äº†ï¼Œä¸€èˆ¬ä¸ä¼šæ˜¯ç”¨æˆ·ç›´æ¥å’Œ LLM äº¤äº’å’Œè°ƒç”¨å¯¹åº”å·¥å…·ï¼Œä¼šæœ‰ä¸€ä¸ªä¸­é—´å•†,æ¯”å¦‚ Agentã€‚
## MCP
### ä»€ä¹ˆæ˜¯ MCP
**MCP(Model Context Protocol) æ˜¯ç”± Anthropic æ¨å‡ºçš„ä¸€é¡¹å¼€æ”¾æ ‡å‡†åè®®ï¼Œæ—¨åœ¨è§£å†³ä¸åŒå¤§æ¨¡å‹ä¸ä¸åŒå¤–éƒ¨å·¥å…·é›†æˆçš„æ ‡å‡†åŒ–é—®é¢˜ã€‚**å®˜æ–¹è§£é‡Šæ˜¯â€œå…¶ç›®æ ‡æ˜¯ä¸ºå¤§å‹è¯­è¨€æ¨¡å‹æä¾›ä¸€ç§å¼€æ”¾ã€æ ‡å‡†åŒ–çš„æ–¹å¼ï¼Œä»¥ä¾¿ä¸å¤–éƒ¨æ•°æ®æºã€å·¥å…·å’ŒæœåŠ¡è¿›è¡Œè¿æ¥ã€‚â€

*   å®ƒè§„å®šäº†ä¸Šä¸‹æ–‡ä¸è¯·æ±‚çš„ç»“æ„åŒ–ä¼ é€’æ–¹å¼ï¼Œå¹¶è¦æ±‚é€šä¿¡æ ¼å¼ç¬¦åˆ JSON-RPC 2.0 æ ‡å‡†ã€‚  
*   ç®€å•ç†è§£ï¼ŒMCP ç›¸å½“äºå¤§æ¨¡å‹é¢†åŸŸçš„â€œHTTP åè®®â€ï¼Œå…¶å¹¶ä¸ç»‘å®šä»»ä½•å¤§æ¨¡å‹ï¼Œè¿™æ„å‘³ç€ç”¨æˆ·å¯ä»¥åœ¨æ”¯æŒ MCP çš„å·¥å…·ä¸­ï¼Œç”¨ä»»ä½•å¤§æ¨¡å‹è°ƒç”¨ MCP æœåŠ¡ã€‚

> åè®®å…·ä½“æè¿°åœ¨è¿™ä¸ªä»“åº“ï¼š[modelcontextprotocol](https://github.com/modelcontextprotocol/modelcontextprotocol) æ„Ÿå…´è¶£çš„ç«¥é‹å¯ä»¥è‡ªè¡ŒæŸ¥é˜…



ä¸€å¥è¯æè¿°ï¼š**MCP æ˜¯ä¸€ç§å¼€æ”¾ã€æ ‡å‡†åŒ–çš„åè®®ï¼Œä»¥ä¾¿å¤§å‹è¯­è¨€æ¨¡å‹èƒ½å¤Ÿä¸å¤–éƒ¨æ•°æ®æºã€å·¥å…·å’ŒæœåŠ¡è¿›è¡Œè¿æ¥ã€‚**
### ä¸ºä»€ä¹ˆéœ€è¦ MCP
åœ¨ MCP çˆ†ç«ä¹‹å‰ï¼ŒFunction Calling å‡½æ•°è°ƒç”¨æ¨¡å¼ä¹Ÿè¢«ä¼—å¤šå¼€å‘è€…å¹¿æ³›é‡‡çº³ã€‚

ä½†æ˜¯ç”±äº**ä¸åŒå‚å•†å¯¹äº Function Calling çš„æ ‡å‡†ã€ä¼˜åŒ–æ–¹å¼å’Œè¿­ä»£è·¯å¾„å‡ä¸ç»Ÿä¸€**ï¼Œå¼€å‘è€…å¯æ ¹æ®è§„åˆ™è‡ªç”±å®šä¹‰å‡½æ•°å’Œ API è°ƒç”¨æ–¹å¼ï¼Œè¿™å…¶ä¸­å°±ä¼šå‡ºç°**ä¸é€šç”¨**çš„é—®é¢˜ï¼Œ**å¯¼è‡´æ™®åŠå›°éš¾ä¸”éœ€è¦é‡å¤å¼€å‘**ï¼Œè¿™å†æ¬¡å‡¸æ˜¾äº† MCP æ ‡å‡†åŒ–çš„é‡è¦æ€§ã€‚

> å¦‚ OpenAI çš„ `tools` å‚æ•°ã€Claude çš„ `tool_use` å­—æ®µã€‚

**å³ä¾¿æ˜¯ä¸æ”¯æŒ Function Calling çš„æ¨¡å‹ï¼Œå¼€å‘è€…éƒ½èƒ½å¤Ÿé€šè¿‡ MCP åè®®çš„æ–¹å¼æ¥è°ƒç”¨ä»»ä½•ä¸€ä¸ªæœåŠ¡ï¼Œè€Œè¿™ä¹Ÿè®©æˆ‘ä»¬è¿›å…¥äº†å·¥å…·ä½¿ç”¨çš„å¹³æƒæ—¶ä»£ã€‚**

ç›®å‰ï¼ŒAnthropic çš„ Claude ç³»åˆ—ï¼ŒOpen AI çš„ GPT ç³»åˆ—ã€Meta çš„ Llama ç³»åˆ—ï¼Œdeepseekã€é˜¿é‡Œçš„é€šä¹‰ç³»åˆ—ï¼ŒAnysphere çš„ Cursorï¼Œå„ç§ä¸»æµæ¨¡å‹å‡å·²æ¥å…¥ MCP ç”Ÿæ€ã€‚
### MCP æ¶æ„
æ¶æ„å¦‚ä¸‹ï¼š

![MCP General Architecture](MCP-General-Architecture.png)

MCP æ¶‰åŠåˆ° 5 ä¸ªç»„ä»¶æˆ–è§’è‰²ï¼š

- **MCP Hosts**: çœŸæ­£ä½¿ç”¨ MCP çš„ç¨‹åºï¼Œä¾‹å¦‚ Claude Desktop, IDEs æˆ–è€…å…¶ä»– AI å·¥å…·

- **MCP Clients**: å®ç° MCP åè®®çš„å®¢æˆ·ç«¯ï¼Œç»´æŒå’Œ MCP Server ä¹‹é—´çš„ 1:1 è¿æ¥

- **MCP Servers**: å®ç° MCP åè®®çš„æœåŠ¡ç«¯ï¼Œé€šè¿‡ MCP åè®®å…¬å¼€æŸäº›åŠŸèƒ½ï¼ŒMCPæœåŠ¡å™¨å¯ä»¥æä¾›ä»¥ä¸‹ç±»å‹çš„åŠŸèƒ½ï¼š

  1. Resources: å®¢æˆ·ç«¯å¯ä»¥è¯»å–çš„ç±»ä¼¼æ–‡ä»¶çš„æ•°æ®ï¼ˆå¦‚APIå“åº”æˆ–æ–‡ä»¶å†…å®¹ï¼‰

  2. Tools: å·¥å…·ï¼šå¯ä»¥ç”±LLMè°ƒç”¨çš„å‡½æ•°ï¼ˆç»ç”¨æˆ·æ‰¹å‡†ï¼‰

  3. Prompts: å¸®åŠ©ç”¨æˆ·å®Œæˆç‰¹å®šä»»åŠ¡çš„é¢„å…ˆç¼–å†™çš„æ¨¡æ¿

  4. â€¦

- **Local Data Sources**: æœ¬åœ°æ•°æ®æºï¼ŒMCP æœåŠ¡å¯ä»¥å®‰å…¨è®¿é—®çš„æœ¬åœ°æ–‡ä»¶ã€æ•°æ®åº“å’Œå…¶ä»–æœåŠ¡

- **Remote Services**: è¿œç¨‹æœåŠ¡ï¼ŒMCP æœåŠ¡å¯ä»¥è¿æ¥çš„å¤–éƒ¨ç³»ç»Ÿ

**éœ€è¦é‡ç‚¹å…³æ³¨çš„å°±æ˜¯ MCP Hostã€MCP Client ä»¥åŠ MCP Server ä¸‰éƒ¨åˆ†**ï¼ŒLocal Data Sourcesã€Remote Services å¯ä»¥çœ‹åšæ˜¯ MCP Server è‡ªèº«å®ç°åŠŸèƒ½çš„ä¸€éƒ¨åˆ†ã€‚

- **MCP Host** å°±æ˜¯ç›´æ¥è·Ÿç”¨æˆ·äº¤äº’çš„åº”ç”¨ç¨‹åºï¼Œä¾‹å¦‚ Claudeï¼Œ**è€Œ MCP Client ä¸€èˆ¬æ˜¯ç›´æ¥é›†æˆåœ¨ MCP Host é‡Œ**ï¼Œè¿™æ ·åº”ç”¨ç¨‹åºæ—¢å¯ä»¥å’Œç”¨æˆ·äº¤äº’ï¼Œä¹Ÿå¯ä»¥è°ƒç”¨ MCP Serverã€‚

- **MCP Server** å°±æ˜¯æä¾› Resourcesã€Toolsã€ Prompts ç­‰ç­‰åŠŸèƒ½çš„æœåŠ¡ç«¯,å¯ä»¥ç®€å•ç†è§£ä¸ºæŠŠ Function Calling ä¸­çš„å‡½æ•°å°è£…ä¸ºäº†æœåŠ¡ï¼Œæ»¡è¶³ MCP æ ‡å‡†ä»è€Œå®ç°åŠŸèƒ½å¤ç”¨ã€‚

### å·¥ä½œæµç¨‹
MCP å·¥ä½œæµç¨‹å’Œ å‰é¢ä»‹ç»çš„ Agentã€FunctionCalling ç±»ä¼¼ï¼š

1ï¼‰MCP client é¦–å…ˆä» MCP server è·å–å¯ç”¨çš„å·¥å…·åˆ—è¡¨

2ï¼‰å°†ç”¨æˆ·çš„ Prompt è¿åŒå·¥å…·æè¿°ä¸€èµ·å‘é€ç»™ LLM

- è¿™é‡Œæ˜¯å¦ä½¿ç”¨ FunctionCalling æ–¹å¼ä¼ é€’ tools ä¿¡æ¯å–å†³äº client çš„å®ç°

- å¦‚æœ Client ä½¿ç”¨ System Prompt æ¨¡æ‹Ÿæ–¹å¼åˆ™ä¸è¦æ±‚æ¨¡å‹æ”¯æŒ FunctionCalling

3ï¼‰LLM æ ¹æ® Prompt å†³å®šæ˜¯å¦éœ€è¦ä½¿ç”¨å·¥å…·ä»¥åŠä½¿ç”¨å“ªäº›å·¥å…·

4ï¼‰å¦‚æœéœ€è¦ä½¿ç”¨å·¥å…·ï¼ŒMCP client ä¼šè°ƒç”¨ MCP server ä»¥æ‰§è¡Œç›¸åº”çš„å·¥å…·è°ƒç”¨

5ï¼‰å·¥å…·è°ƒç”¨çš„ç»“æœå†æ¬¡è¢«å‘é€å› LLM

6ï¼‰LLM æ•´åˆæ‰€æœ‰ä¿¡æ¯ç”Ÿæˆæœ€ç»ˆå›ç­”

7ï¼‰æœ€åå°†å“åº”å±•ç¤ºç»™ç”¨æˆ·

MCP Client ä¸€èˆ¬é›†æˆåœ¨ MCP Host ä¸­ï¼Œæ¯”å¦‚ Claude Desktopï¼Œå› æ­¤å°±ç”»åœ¨ä¸€èµ·äº†ã€‚

ä¸»è¦åŒºåˆ«åœ¨äºå¤–éƒ¨å·¥å…·ä¿¡æ¯è·å–å’Œè°ƒç”¨æ–¹å¼ä¸Šï¼š

- MCP åè®®å°†å¤–éƒ¨å·¥å…·å®šä¹‰ä¸º MCP Serverï¼ŒClient é€šè¿‡è¿æ¥ MCP Server è·å–æ”¯æŒçš„ tools åˆ—è¡¨ï¼Œå¹¶é€šè¿‡ MCP åè®®è¿›è¡Œè°ƒç”¨

- è€Œ FunctionCalling ä¸­ï¼Œtools ä¿¡æ¯æ˜¯æå‰é…ç½®å¥½çš„ï¼ŒåŒæ—¶ tools çš„è°ƒç”¨ä¸€èˆ¬æ˜¯è°ƒç”¨æœ¬åœ° function

å› æ­¤ï¼Œå¯ä»¥ç®€å•ç†è§£ä¸º MCP å°±æ˜¯å°† Function Calling è¿›è¡Œäº†æ ‡å‡†åŒ–ã€‚

### Function Calling å’Œ MCP å·®å¼‚
é¦–å…ˆ Function Calling å’Œ MCP äºŒè€…éƒ½æ˜¯ä¸ºäº†è®©æ¨¡å‹èƒ½å¤Ÿè°ƒç”¨å¤–éƒ¨å·¥å…·ï¼Œå‡è®¾å°†è¿™ä¸ªè¿‡ç¨‹åˆ†ä¸ºä¸‰éƒ¨åˆ†ï¼š

1ï¼‰æ¨¡å‹æ„ŸçŸ¥ tools ä¿¡æ¯

2ï¼‰æ¨¡å‹ç”Ÿæˆ tool è°ƒç”¨è¯·æ±‚

3ï¼‰è°ƒç”¨æŒ‡å®š tool

ç¬¬ä¸€æ­¥ï¼šæ¨¡å‹æ„ŸçŸ¥ tools ä¿¡æ¯ï¼Œæœ‰å¤šç§æ–¹æ³•ï¼š

- å¯ä»¥ä½¿ç”¨ System Prompt ä¼ é€’ tools ä¿¡æ¯

- å¯¹äº Function Calling å®ç°ï¼Œä¹Ÿæ˜¯éæ ‡å‡†çš„ï¼Œä¾‹å¦‚ OpenAI çš„ tools å‚æ•°ã€Claude çš„ tool_use å­—æ®µ

- MCP å¹¶æ²¡æœ‰å¯¹è¿™ä¸€æ­¥åšç‰¹æ®Šé™åˆ¶ï¼Œä¸»è¦å–å†³äº MCP Host çš„å®ç°ï¼Œ ä» MCP Server è·å–åˆ° tools ä¿¡æ¯ä¹‹åï¼Œå¯ä»¥ä½¿ç”¨ Function Calling å‘ŠçŸ¥æ¨¡å‹ï¼Œä¹Ÿå¯ä»¥ç”¨åˆ«çš„æ–¹å¼å¦‚ System Promptã€‚

ç¬¬äºŒæ­¥ï¼šæ¨¡å‹ç”Ÿæˆ tool è°ƒç”¨è¯·æ±‚ï¼Œè¿™ä¸€æ­¥å…¶å®ä¸»è¦æ˜¯æ¨¡å‹ä¸Šçš„å·®å¼‚ï¼š

- å¯¹äºä¸æ”¯æŒ Function Calling çš„æ¨¡å‹ä¸€èˆ¬æ˜¯ä¾é è‡ªç„¶è¯­è¨€ç”Ÿæˆèƒ½åŠ›åœ¨å¤„ç†è¿™ä¸ªè¯·æ±‚

- å¯¹äºæ”¯æŒ Function Calling çš„æ¨¡å‹ï¼Œä¸€èˆ¬æ˜¯ç»è¿‡ç‰¹æ®Šæ•°æ®é›†å¾®è°ƒçš„ï¼Œåœ¨å¤„ç†è¿™ç§è¯·æ±‚ä¸Šä¼šæ›´åŠ å‡†ç¡®

ç¬¬ä¸‰æ­¥ï¼štool çš„è°ƒç”¨ä¸Šä¹Ÿæœ‰åŒºåˆ«ï¼š

- å¯¹äºé MCP æ¥è¯´ï¼Œæ¥æ”¶åˆ°æ¨¡å‹çš„è¿”å›åæ€ä¹ˆè°ƒç”¨å·¥å…·å°±çœ‹å¼€å‘è€…æ€ä¹ˆå®ç°äº†ï¼Œå¯ä»¥æ˜¯ç›´æ¥è°ƒç”¨æœ¬åœ° Functionï¼Œä¹Ÿå¯ä»¥æ˜¯è°ƒç”¨è¿œç¨‹ API éƒ½æ²¡é—®é¢˜

- å¯¹äº MCP æ¥è¯´å°±æ˜¯æŒ‰ç…§ MCP åè®®è°ƒç”¨ MCP Server

ä¹Ÿå°±æ˜¯è¯´ï¼š

- MCP æ›´å¤šçš„æ˜¯åœ¨å®šä¹‰ï¼šMCP Server æ€ä¹ˆå¯¹å¤–æš´éœ²èƒ½åŠ›ï¼Œå…¶ä»–äººè¯¥æ€ä¹ˆè°ƒç”¨ MCP Serverã€‚

- Function Calling æ›´å¤šå…³æ³¨çš„æ˜¯ï¼šæ€ä¹ˆæŠŠ tools ä¿¡æ¯å‘ŠçŸ¥ç»™æ¨¡å‹ï¼Œä»¥åŠæ¨¡å‹å¦‚ä½•åˆ¤æ–­è¯¥è°ƒç”¨å“ªä¸ª tool

å› æ­¤äºŒè€…å…¶å®æ˜¯äº’è¡¥çš„å…³ç³»ã€‚

## A2A
### ä»€ä¹ˆæ˜¯ A2A
2025å¹´4æœˆ9æ—¥ï¼ŒGoogleå‘å¸ƒäº†æ–‡ç« [ã€ŠA2A: A new era of agent interoperabilityã€‹](https://developers.googleblog.com/en/a2a-a-new-era-of-agent-interoperability/)ï¼Œæå‡ºäº†ä¸€ä¸ªæ–°çš„å¼€æ”¾åè®®**A2Aï¼ˆAgent-to-Agentï¼‰**Â ï¼Œå…è®¸ AI Agent ä¹‹é—´åœ¨å„ç§ä¼ä¸šå¹³å°æˆ–åº”ç”¨ç¨‹åºä¸Šç›¸äº’é€šä¿¡ã€å®‰å…¨åœ°äº¤æ¢ä¿¡æ¯å’Œåè°ƒè¡ŒåŠ¨ã€‚

4æœˆ10æ—¥ï¼Œåœ¨Google Cloud Next 2025å¤§ä¼šä¸Šï¼Œè°·æ­Œå¼€æºäº†Agent2Agent Protocolã€‚

**A2A(Agent to Agent) æ˜¯**ä¸€é¡¹å¼€æ”¾æ ‡å‡†ï¼Œå¯è®©ä¸åŒå¹³å°å’Œæ¡†æ¶ä¹‹é—´çš„AI Agent è¿›è¡Œé€šä¿¡å’Œåä½œï¼Œè€Œæ— éœ€è€ƒè™‘å…¶åº•å±‚æŠ€æœ¯ã€‚å…¶æ—¨åœ¨é€šè¿‡å®ç°çœŸæ­£çš„å¤š Agent åœºæ™¯ï¼Œæœ€å¤§é™åº¦åœ°å‘æŒ¥A gentic AI çš„ä¼˜åŠ¿ã€‚

A2A çš„æ ¸å¿ƒä½œç”¨æ˜¯è§£å†³Agentä¹‹é—´çš„æ²Ÿé€šå’Œåä½œï¼Œä»¥åŠ Agent ä¸ç”¨æˆ·çš„äº¤äº’ã€‚å³ Agent ä¹‹é—´èƒ½åƒäººä¸äººäº¤æµä¸€æ ·ï¼Œä¼ é€’æ„å›¾ã€åå•†ä»»åŠ¡ã€å…±äº«ä¿¡æ¯ã€‚A2A ä½¿å¼€å‘äººå‘˜æ„å»ºçš„ Agentï¼Œèƒ½å¤Ÿè¿æ¥ä»»ä½•å…¶å®ƒçš„ Agentï¼ˆåŸºäº A2A æ„å»ºï¼‰ï¼Œå¹¶ä½¿ç”¨æˆ·èƒ½å¤Ÿçµæ´»ç»„åˆæ¥è‡ªä¸åŒä¾›åº”å•†çš„ Agentã€‚æœ€é‡è¦çš„æ˜¯ï¼Œä¼ä¸šå¯ä»¥é€šè¿‡æ ‡å‡†åŒ–æ–¹æ³•ç®¡ç†å…¶è·¨ä¸åŒå¹³å°å’Œäº‘ç¯å¢ƒçš„Agentã€‚

ä¸€å¥è¯æè¿°ï¼š**A2A(Agent to Agent) æ˜¯ä¸€ç§å¼€æ”¾æ ‡å‡†ï¼Œå¯è®©ä¸åŒå¹³å°å’Œæ¡†æ¶ä¹‹é—´çš„AI Agent è¿›è¡Œé€šä¿¡å’Œåä½œï¼Œè€Œæ— éœ€è€ƒè™‘å…¶åº•å±‚æŠ€æœ¯çš„åè®®ã€‚**

### ä¸ºä»€ä¹ˆéœ€è¦ A2A
å› ä¸ºæ„å»ºä¸€ä¸ªèƒ½è§£å†³æ‰€æœ‰é—®é¢˜çš„ Agent å¾ˆéš¾ï¼Œæˆ–è€…è¯´åŸºæœ¬ä¸å¯èƒ½å®ç°ï¼Œå› æ­¤ä¸€èˆ¬é€‰æ‹©å¦ä¸€æ¡è·¯ï¼šå¤š Agent åˆ†å·¥åä½œã€‚

æ¯ä¸ª Agent åªéœ€è¦ä¸“æ³¨æŸä¸€æ–¹é¢è§£å†³ï¼Œé€šè¿‡ A2A è®©å¤šä¸ªä¸åŒé¢†åŸŸçš„ Agent åä½œè§£å†³é—®é¢˜ï¼Œå¤šä¸ª Agent æ„æˆæµæ°´çº¿å…±åŒå®ŒæˆæŸä¸ªä»»åŠ¡ã€‚

> æ€ä¹ˆæœ‰ç‚¹ MoE çš„æ„Ÿè§‰ ğŸ˜‚

**Agent ä¹‹é—´é€šè¿‡ A2A åè®®é€šä¿¡ï¼ŒAgent é€šè¿‡ MCP åè®®è°ƒç”¨å¤–éƒ¨å·¥å…·ï¼Œ**Â å¦‚ä¸‹å›¾æ‰€ç¤ºï¼š

![A2A Architecture](a2a-arch.png)
> å›¾æºï¼š[https://google.github.io/A2A/#a2a-and-mcp-complementary-protocols](https://google.github.io/A2A/#a2a-and-mcp-complementary-protocols)
### å…³é”®åŸåˆ™&æ ¸å¿ƒèƒ½åŠ›
**A2A åœ¨è®¾è®¡æ—¶åšæŒçš„äº”ä¸ªå…³é”®åŸåˆ™ï¼š**

- Â **Embrace agentic capabilitiesï¼šæ‹¥æŠ±æ™ºèƒ½ä½“èƒ½åŠ›**ï¼Œæ”¯æŒè‡ªç„¶ã€éç»“æ„åŒ–çš„åä½œæ¨¡å¼ã€‚
    
- Â **Build on existing standards: å¤ç”¨ç°æœ‰æ ‡å‡†**,ä½¿ç”¨ HTTPã€Server-Sent Events (SSE) å’Œ JSON-RPCï¼Œç¡®ä¿ä¸ç°æœ‰ç³»ç»Ÿçš„å…¼å®¹æ€§ã€‚
    
- Â **Secure by defaultï¼šé»˜è®¤å®‰å…¨**ï¼Œæ”¯æŒä¼ä¸šçº§è®¤è¯å’Œæˆæƒï¼Œå¯åŠ¨æ—¶ä¸Â OpenAPI ä¿æŒä¸€è‡´ã€‚
    
- Â **Support for long-running tasksï¼šæ”¯æŒé•¿æœŸä»»åŠ¡ï¼Œ**Â å¤„ç†ä»å¿«é€Ÿä»»åŠ¡åˆ°æ·±å…¥ç ”ç©¶çš„ä»»åŠ¡ï¼Œæä¾›å®æ—¶åé¦ˆã€é€šçŸ¥å’ŒçŠ¶æ€æ›´æ–°ã€‚
    
- Â **Modality agnostic:**Â **å¤šæ¨¡æ€æ”¯æŒ **ï¼Œæ”¯æŒæ–‡æœ¬ã€éŸ³é¢‘ã€è§†é¢‘æµç­‰å¤šæ¨¡æ€é€šä¿¡ã€‚
    

> åè®®å…·ä½“æè¿°åœ¨è¿™ä¸ªä»“åº“ï¼š[google/A2A](https://github.com/google/A2A)Â æ„Ÿå…´è¶£çš„ç«¥é‹å¯ä»¥è·³è½¬æŸ¥çœ‹

**A2A çš„æ ¸å¿ƒèƒ½åŠ›ï¼š**

![A2A Core](a2a-core.png)

- Â **Capability discoveryï¼šèƒ½åŠ›å‘ç°** ,Agent ä½¿ç”¨ JSON æ ¼å¼çš„ â€˜Agent Cardâ€™ æ¥æš´éœ²è‡ªå·±çš„èƒ½åŠ›ï¼Œå…¶ä»– Agent å¯ä»¥æ ¹æ®è¯¥ä¿¡æ¯é€‰æ‹©æ‰§è¡Œä»»åŠ¡çš„æœ€ä½³ Agentï¼Œç„¶åä½¿ç”¨ A2A å’Œç›®æ ‡ Remote Agent é€šä¿¡ã€‚
    
- **Task managementï¼šä»»åŠ¡ç®¡ç†**ï¼ŒAgent ç›´æ¥çš„é€šä¿¡æ˜¯ä»¥å®Œæˆä»»åŠ¡ä¸ºå¯¼å‘çš„ï¼Œä»»åŠ¡ç”±åè®®å®šä¹‰ï¼Œå¯¹äºé•¿æ—¶é—´çš„ä»»åŠ¡ï¼ŒAgent ä¹‹é—´ä¼šé€šä¿¡ä»¥ä¿æŒåŒæ­¥çŠ¶æ€ã€‚
    
- **Collaborationï¼šåä½œ**ï¼ŒAgent ä¹‹é—´ä»£ç†å¯ä»¥ç›¸äº’å‘é€æ¶ˆæ¯ï¼Œä»¥ä¼ è¾¾ ä¸Šä¸‹æ–‡, å›å¤, å·¥ä»¶æˆ–è€…ç”¨æˆ·æŒ‡ä»¤ã€‚
    
- Â **User experience negotiation: ç”¨æˆ·ä½“éªŒåå•†**ï¼Œæ”¯æŒä¸åŒå†…å®¹ç±»å‹ï¼ˆå¦‚å›¾åƒã€iframeã€è§†é¢‘ã€ç½‘é¡µè¡¨å•ï¼‰ï¼Œæä¾›ä¸°å¯Œçš„äº¤äº’ã€‚
### A2A å·¥ä½œæµç¨‹
#### æ¦‚å¿µ
A2A ä¸­æ¯”è¾ƒé‡è¦çš„æ¦‚å¿µï¼š

- Â **Agent Card**ï¼šç›¸å½“äºæ™ºèƒ½ä½“çš„"èº«ä»½è¯+èƒ½åŠ›è¯´æ˜ä¹¦"ï¼Œç”¨äºå¯¹å¤–å…¬å¼€è‡ªèº«æŠ€èƒ½å’ŒæœåŠ¡æ¥å£ã€‚
    
    - Â ä»¥ JSON æ ¼å¼å­˜å‚¨åœ¨æœåŠ¡å™¨çš„Â `/.well-known/agent.json`Â è·¯å¾„
        
    - Â åŒ…å«åç§°ã€ç‰ˆæœ¬ã€èƒ½åŠ›æè¿°ï¼ˆå¦‚æ”¯æŒçš„ä»»åŠ¡ç±»å‹ï¼‰ã€è®¤è¯æ–¹å¼ï¼ˆAPI Key/OAuthï¼‰ã€å¯è®¿é—®çš„ HTTP ç«¯ç‚¹ï¼ˆå¦‚ä»»åŠ¡æäº¤ URLï¼‰
        
- Â **A2A Client**ï¼šä»»åŠ¡å‘èµ·æ–¹ï¼Œå¯ä»¥æ˜¯ç”¨æˆ·åº”ç”¨æˆ–å…¶ä»–æ™ºèƒ½ä½“ã€‚
    
- Â **A2A Server**ï¼šæ™ºèƒ½ä½“çš„"ä»»åŠ¡å¤„ç†ä¸­å¿ƒ"ï¼Œè´Ÿè´£æ¥æ”¶è¯·æ±‚å¹¶åè°ƒä»»åŠ¡æ‰§è¡Œã€‚
    
- Â **Task**ï¼šåè®®ä¸­çš„æœ€å°å·¥ä½œå•å…ƒï¼Œä»£è¡¨éœ€è¦å®Œæˆçš„ç”¨æˆ·éœ€æ±‚ã€‚
    
    - Â ç”Ÿå‘½å‘¨æœŸï¼šåŒ…å« 6 ç§çŠ¶æ€æµè½¬ï¼šå·²æäº¤ï¼ˆSubmittedï¼‰â†’ å¤„ç†ä¸­ï¼ˆWorkingï¼‰â†’ éœ€è¾“å…¥ï¼ˆInput-Requiredï¼‰â†’ å®Œæˆ/å¤±è´¥/å–æ¶ˆ
        
    - Â å”¯ä¸€æ ‡è¯†ï¼šæ¯ä¸ª Task æœ‰å…¨å±€å”¯ä¸€çš„ IDï¼Œæ”¯æŒè·¨æ™ºèƒ½ä½“è¿½è¸ªè¿›åº¦
        
    - Â æ‰§è¡Œæ¨¡å¼ï¼š
        
        - Â å³æ—¶ä»»åŠ¡ï¼ˆå¦‚æŸ¥è¯¢å¤©æ°”ï¼‰ï¼šåŒæ­¥è¿”å›ç»“æœ
            
        - Â é•¿æœŸä»»åŠ¡ï¼ˆå¦‚ä¾›åº”é“¾ä¼˜åŒ–ï¼‰ï¼šé€šè¿‡ SSE æ¨é€å®æ—¶çŠ¶æ€æ›´æ–°
            
- Â **Message**ï¼šæ™ºèƒ½ä½“é—´é€šä¿¡çš„è½½ä½“ï¼Œæ”¯æŒå¤šæ¨¡æ€äº¤äº’ã€‚
    

![A2A Workflow](A2A-Workflow.png)

> å›¾æºï¼š[https://google.github.io/A2A/specification/](https://google.github.io/A2A/specification/)
#### å·¥ä½œæµ
æµç¨‹å¦‚ä¸‹ï¼š

- Â 1ï¼‰å‘ç° Agentï¼šé€šè¿‡ Agent Cardï¼Œäº†è§£æ™ºèƒ½ä½“çš„èƒ½åŠ›ã€‚
    
- Â 2ï¼‰å‘é€ä»»åŠ¡ï¼šå®¢æˆ·ç«¯å‘é€ä»»åŠ¡è¯·æ±‚ï¼š
    
    - Â ä½¿ç”¨ tasks/send å¤„ç†å³æ—¶ä»»åŠ¡ï¼Œè¿”å›æœ€ç»ˆ Task å¯¹è±¡ã€‚
        
    - Â ä½¿ç”¨ tasks/sendSubscribe å¤„ç†é•¿æœŸä»»åŠ¡ï¼ŒæœåŠ¡å™¨é€šè¿‡ SSE äº‹ä»¶å‘é€æ›´æ–°ã€‚
        
- Â 3/4ï¼‰å¤„ç†ï¼šæœåŠ¡å™¨å¤„ç†ä»»åŠ¡ï¼Œå¯èƒ½æ¶‰åŠæµå¼æ›´æ–°æˆ–ç›´æ¥è¿”å›ç»“æœã€‚
    
- Â 5ï¼‰äº¤äº’ï¼ˆå¯é€‰ï¼‰ï¼šè‹¥ä»»åŠ¡çŠ¶æ€ä¸º input-requiredï¼Œå®¢æˆ·ç«¯å¯å‘é€æ›´å¤šæ¶ˆæ¯ï¼Œä½¿ç”¨ç›¸åŒ Task ID æä¾›è¾“å…¥ã€‚
    
- Â 6ï¼‰å®Œæˆï¼šä»»åŠ¡è¾¾åˆ°ç»ˆç«¯çŠ¶æ€ï¼ˆå¦‚ completedã€failed æˆ– canceledï¼‰ã€‚
    
### A2A å’Œ MCP åä½œ
A2A ç¤¾åŒºæ¨èå°† Agent å»ºæ¨¡ä¸º MCP èµ„æº(ä¹Ÿå°±æ˜¯æŠŠ Agent Card å­˜èµ·æ¥)ï¼Œè¿™æ ·å…¶ä»– Agent å¯ä»¥é€šè¿‡ MCP è·å–åˆ° Agent Card ä»è€Œæ„ŸçŸ¥åˆ°å…¶ä»– Agent çš„ä¿¡æ¯ã€‚

![A2A-MCP](A2A-MCP.png)

> å›¾æºï¼š[https://google.github.io/A2A/topics/a2a-and-mcp/#intersection](https://google.github.io/A2A/topics/a2a-and-mcp/#intersection)

MCP è§£å†³çš„æ˜¯ Agent ä¸å¤–éƒ¨å·¥å…·çš„æ ‡å‡†åŒ–è¿æ¥é—®é¢˜ï¼Œè€Œ A2A è§£å†³çš„æ˜¯ Agent ä¹‹é—´çš„åä½œé—®é¢˜ï¼Œä¸¤è€…å…±åŒæ„æˆæ™ºèƒ½ä½“ç”Ÿæ€çš„åŸºç¡€åè®®ã€‚
## å°ç»“
æ¦‚å¿µï¼š

- **Agent æ˜¯ä¸€ä¸ªä»¥ LLM ä¸ºåŸºç¡€ï¼Œç»“åˆå…¶ä»–å¤–éƒ¨å·¥å…·è¾…åŠ©ï¼Œæœ€ç»ˆèƒ½å¤Ÿå®Œæˆå¤æ‚ä»»åŠ¡çš„å®ä½“(å·¥å…·ã€åŠ©æ‰‹)ã€‚**

é¦–å…ˆæ„å»ºä¸€ä¸ªå¼ºå¤§çš„ Agent æ˜¯æˆ‘ä»¬çš„æœ€ç»ˆç›®çš„ï¼Œæ ¹æ® Agent å®šä¹‰ LLM + å¤–éƒ¨å·¥å…· = Agentï¼Œé‚£ä¹ˆå¦‚ä½•è®© LLM è°ƒç”¨å¤–éƒ¨å·¥å…·å‘¢ï¼ŒFunctionCalling å’Œ MCP ä¸¤æ¡è·¯ï¼š

- Â **FunctionCalling æ˜¯ä¸€ç§å…è®¸æ¨¡å‹é€šè¿‡ç”Ÿæˆç»“æ„åŒ– JSON è¾“å‡ºï¼Œä»¥â€™è°ƒç”¨â€™å¤–éƒ¨ç³»ç»Ÿä¸­é¢„å®šä¹‰çš„å‡½æ•°çš„æœºåˆ¶ã€‚**
    
- Â  **MCP æ˜¯ä¸€ç§å¼€æ”¾ã€æ ‡å‡†åŒ–çš„åè®®ï¼Œä»¥ä¾¿å¤§å‹è¯­è¨€æ¨¡å‹èƒ½å¤Ÿä¸å¤–éƒ¨æ•°æ®æºã€å·¥å…·å’ŒæœåŠ¡è¿›è¡Œè¿æ¥ã€‚**
    

åœ¨æ„å»º Agent ä¹‹åï¼Œå¦‚ä½•è®© Agent æ›´åŠ å¼ºå¤§å‘¢ï¼Œé™¤äº†æ„å»ºå•ä¸ªå¼ºå¤§çš„ Agent ä¹‹å¤–ï¼Œæˆ‘ä»¬å¯ä»¥è®©å¤šä¸ª Agent è¿›è¡Œåä½œï¼Œå¤ç”¨å…¶ä»– Agent çš„èƒ½åŠ›ï¼š

- **A2A(Agent to Agent) æ˜¯ä¸€ç§å¼€æ”¾æ ‡å‡†ï¼Œå¯è®©ä¸åŒå¹³å°å’Œæ¡†æ¶ä¹‹é—´çš„AI Agent è¿›è¡Œé€šä¿¡å’Œåä½œï¼Œè€Œæ— éœ€è€ƒè™‘å…¶åº•å±‚æŠ€æœ¯çš„åè®®ã€‚**

ä¸ªäººç†è§£ï¼š

- Â LLM æ˜¯ä¸€åˆ‡çš„åŸºç¡€
    
- Â Agent æ˜¯æˆ‘ä»¬è¦å®ç°çš„ç›®æ ‡ï¼Œä¸€ä¸ªèƒ½å¤Ÿè§£å†³å¤æ‚ä»»åŠ¡çš„åŠ©æ‰‹
    
- Â ä¸ºäº†èƒ½å¤Ÿè§£å†³å¤æ‚é—®é¢˜ï¼ŒAgent éœ€è¦åœ¨ LLM åŸºç¡€ä¸Šç»“åˆå…¶ä»–å¤–éƒ¨å·¥å…·çš„è¾…åŠ©
    
- Â FunctionCalling æ˜¯ LLM è°ƒç”¨å¤–éƒ¨å·¥å…·çš„ä¸€ç§å®ç°æ‰‹æ®µ
    
- Â MCP åˆ™å¯ä»¥çœ‹åšæ˜¯è¿™ç§æ‰‹æ®µçš„æ ‡å‡†åŒ–
    
- Â LLM + FunctionCalling æˆ–è€… MCP æˆ‘ä»¬å®ç°äº†ä¸€ä¸ªå¼ºå¤§çš„ Agent
    
- Â ä½†æ˜¯æƒ³è¦æ„å»ºä¸€ä¸ªå…­è¾¹å½¢æˆ˜å£«å¾ˆéš¾ï¼Œå› æ­¤æˆ‘ä»¬è®©æ¯ä¸ª Agent åªéœ€è¦ä¸“æ³¨æŸä¸€æ–¹é¢ï¼Œé€šè¿‡ A2A è®©å¤šä¸ªä¸åŒé¢†åŸŸçš„ Agent åä½œè§£å†³é—®é¢˜

## æ¨èé˜…è¯»
- Â [https://platform.openai.com/docs/guides/function-calling](https://platform.openai.com/docs/guides/function-calling)
    
- Â [https://modelcontextprotocol.io/introduction](https://modelcontextprotocol.io/introduction)
    
- Â [Function-Calling vs. Model Context Protocol (MCP): Choosing the Right Approach for LLM Integration |](https://www.runloop.ai/blog/function-calling-vs-model-context-protocol-mcp)
    
- Â [a-a-new-era-of-agent-interoperability](https://developers.googleblog.com/en/a2a-a-new-era-of-agent-interoperability/)
    
- Â [https://google.github.io/A2A/topics/what-is-a2a/](https://google.github.io/A2A/topics/what-is-a2a/)
    
- Â [https://agent2agent.biz/](https://agent2agent.biz/)
    
- Â [MCP ä¸ Function Call åŒºåˆ« - èˆèˆä¿Š - åšå®¢å›­](https://www.cnblogs.com/ghj1976/p/18602070/mcp-yu-function-call-qu-bie)
    
- Â [è®¨è®ºï½œè°èƒ½ç»Ÿä¸€ Agent æ¥å£ï¼ŸMCP å¯¹æ¯” A2A ã€Function Calling](https://my.oschina.net/u/4209276/blog/18168155)